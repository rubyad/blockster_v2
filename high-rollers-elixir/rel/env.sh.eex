#!/bin/sh

if [ -n "$FLY_APP_NAME" ]; then
  # Use static node name based on IP only - prevents Mnesia data loss when deployment IDs change
  export RELEASE_NODE="high_rollers@${FLY_PRIVATE_IP}"
  # configure node for distributed erlang with IPV6 support
  export ERL_AFLAGS="-proto_dist inet6_tcp"
fi

export RELEASE_DISTRIBUTION="name"

# when not running on fly.io, use a sensible default
export RELEASE_NODE=${RELEASE_NODE:-<%= @release.name %>@$(hostname)}
